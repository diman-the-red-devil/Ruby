# Ruby / Урок 03. Программа

[![Содержание](https://img.shields.io/badge/-%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5-purple)](README.md)
[![Вперед](https://img.shields.io/badge/-%D0%92%D0%BF%D0%B5%D1%80%D0%B5%D0%B4-brightgreen)](2.Практика.md)

***

## 1. Файлы программ Ruby

Программа на **Ruby** представляет собой текстовый файл с расширением **.rb**, 
содержащий последовательность инструкций — команд и описаний. 

Программа может быть разделена на несколько файлов. 
В этом случае главный файл программы должен загрузить остальные файлы 
с помощью инструкции **require** или **require_relative**.
По данной инструкции происходит поиск файла с указанным именем (с расширением **.rb**) и его загрузка. 
Если файла исходного кода с таким именем нет, интерпретатор пытается загрузить динамическую библиотеку с тем же именем 
(расширения зависят от операционной системы). 

Пути поиска файлов определяются инструкцией загрузки: 

* **require** использует для загрузки набор каталогов, заданных настройками среды и параметрами запуска интерпретатора
* **require_relative** загружает файл с указанным путём относительно текущего файла 

*Пример:*

```ruby
require 'module1'       # загрузка программного файла с именем 'module1.rb' либо библиотеки с именем 'module1'
require 'pkgs/package2' # загрузка программного файла 'package2' из подкаталога pkgs
```

*Результат:*

Если файл, содержащий инструкции загрузки, находится в каталоге */home/programmer/work/ruby/testproject*, 
то файл *package2.rb* будет загружаться из */home/programmer/work/ruby/testproject/pkgs*.

При загрузке программный модуль обрабатывается интерпретатором, то есть выполняются все его инструкции. 

>Если модуль загружается в нескольких файлах, то его загрузка происходит только один раз. 

В Ruby имеется метод **load**, также выполняющий загрузку файла исходного кода либо библиотеки, 
он несколько отличается функциональностью и обычно применяется для загрузки бинарных модулей, написанных на **C**.

***

## 2. Структура программы Ruby

Программа на **Ruby** состоит из отдельных строк, как в **C**, но не как в древних языках наподобие **FORTRAN**. 
В одной строке может быть сколько угодно лексем, лишь бы они правильно отделялись пропусками.
В одной строке может быть несколько предложений, разделенных точками с запятой (**;**).
только в этом случае точка с запятой и необходима. 

В современных версиях **Ruby** логические выражения и последовательности вызова методов можно переносить на несколько
строк. В ранних версиях **Ruby** (до версии 1.9) для этого необходимо было использовать  
символ переноса строки "\" — обратную косую черту.

В **Ruby** не требуется организовывать тело главной программы в виде специального программного модуля 
(подобно функции main() в **Си**), составляющие его команды просто записываются непосредственно 
в тексте файла программы. 

***

## 3. Разделители в программе Ruby

Пробельные символы, такие как пробелы и табуляция, обычно игнорируются в коде **Ruby** 
(в отличие от программ на **Python**), 
за исключением случаев, когда они появляются в строках. 
Иногда, однако, они используются для интерпретации неоднозначных утверждений. 
Интерпретации этого типа вызывают предупреждения, когда опция -w включена.

*Пример:*

```ruby
a + b
a  +b
```

*Результат:*

Первая строка интерпретируется как a+b (Сложение двух локальных переменных).
Вторая строка интерпретируется как  a(+b) (Вызов метода).

**Ruby** интерпретирует точки с запятой и символы новой строки как конец оператора. 
Однако, если **Ruby** встречает операторы, такие как +, – или обратная косая черта в конце строки, 
они указывают на продолжение оператора.
 
***
 
## 4. Заявления BEGIN и END 
      
### 4.1. Заявление BEGIN

**Заявление BEGIN** объявляет код, который вызывается до запуска программы.

Синтаксис

```ruby
BEGIN {
   code
}
```

*Пример:*

```ruby
puts "Это основная программа Ruby"

BEGIN {
   puts "Инициализация программы Ruby"
}
```

*Результат:*

```text
Инициализация программы Ruby
Это основная программа Ruby
```

### 4.2. Заявление END

**Заявление END** объявляет код, который будет вызываться в конце программы.

Синтаксис

```ruby
END {
   code
}
```

*Пример:*


```ruby
puts "Это основная программа Ruby"

END {
   puts "Завершение программы Ruby "
}
BEGIN {
   puts "Инициализация программы Ruby"
}
``` 

*Результат:*

```text
Инициализация программы Ruby
Это основная программа Ruby
Завершение программы Ruby 
```

***

## 5. Выполнение программ Ruby

Интерпретатор **Ruby** проводит синтаксический анализ программы как последовательность лексем. 
Лексемы состоят из комментариев, литералов, знаков пунктуации, идентификаторов и ключевых слов.
При запуске программного файла на исполнение интерпретатор последовательно читает файл и выполняет инструкции. 
Поскольку программный файл обрабатывается интерпретатором последовательно, любые функции, методы, 
описания должны предшествовать в тексте программы их первому использованию.

### 5.1. С помощью irb

***Interactive Ruby Shell (IRB)*** - командная оболочка для программирования на объектно-ориентированном языке **Ruby**, 
которая входит во все дистрибутивы и сама написана на **Ruby**. 
Программа запускается из командной строки командой **irb** и позволяет выполнять команды языка **Ruby** в реальном времени. 
Поддерживается история введённых команд, редактирование, возможность обращаться к веб-сайтам и локальному веб-серверу.

Чтобы посмотреть результат выполнения большинства примеров на **Ruby** не обязательно создавать файл. 
Достаточно использовать **IRB**. Это хороший способ для экспериментов с **Ruby** и проверки как работает кусок кода.

```shell script
C:\Users\diman> irb
irb(main):001:0> n = 5
=> 5
irb(main):002:0> def fact(n)
irb(main):003:1>   if n <= 1
irb(main):004:2>     1
irb(main):005:2>   else
irb(main):006:2*     n * fact(n - 1)
irb(main):007:2>   end
irb(main):008:1> end
=> nil
irb(main):009:0> fact(n)
=> 120
```

### 5.2. С помощью ruby

Программы на языке **Ruby** это текстовые файлы, не подлежащие компиляции. 
Для их исполнения нужен интерпретатор. 
Чтобы запустить программу на **Ruby**, необходимо вызвать интерпретатор командой **ruby** и 
передать ему имя файла с программой в качестве параметра.
Интерпретатор **Ruby** прочитает указанный файл, и выведет его содержание. 

Чтобы запустить программу с именем test_program.rb, нужно вызвать консоль и набрать:

```bash
ruby test_program.rb
```

***

Практика [![Перейти](https://img.shields.io/badge/-%D0%9F%D0%B5%D1%80%D0%B5%D0%B9%D1%82%D0%B8-blue)](2.Практика.md)